<!DOCTYPE html>
<html>
<head>
  <title>Forearm Anatomy Quiz</title>
  <script src="https://static.sketchfab.com/api/sketchfab-viewer-1.12.1.js"></script>
  <style>
    body { margin: 0; font-family: Arial, sans-serif; }
    #api-frame { width: 100%; height: 600px; border: none; }
    #quiz-overlay {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(255, 255, 255, 0.95);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
      z-index: 10;
      max-width: 320px;
    }
    button {
      display: block;
      margin-top: 10px;
      padding: 8px 12px;
      font-size: 14px;
      width: 100%;
    }
    #next-btn {
      margin-top: 15px;
      background-color: #1CAAD9;
      color: white;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>

<!-- Sketchfab Viewer -->
<iframe id="api-frame" allow="autoplay; fullscreen" allowfullscreen></iframe>

<!-- Quiz Overlay -->
<div id="quiz-overlay">
  <div id="question-container"></div>
  <button id="next-btn" onclick="nextQuestion()">Next Question</button>
</div>

<script>
  const iframe = document.getElementById('api-frame');
  const client = new Sketchfab(iframe);
  const uid = '3ca355716d074b4a85ba709c37297b46'; // Forearm model UID

  let currentQuestionIndex = 0;
  let score = 0;

  const questions = [
    {
      question: "Which muscle is labeled 'A'?",
      options: ["Flexor carpi radialis", "Extensor digitorum"],
      correct: "Flexor carpi radialis",
      annotationIndex: 0
    },
    {
      question: "Identify the Pronator Teres muscle.",
      options: ["Pronator Teres", "Flexor digitorum superficialis"],
      correct: "Pronator Teres",
      annotationIndex: 1
    }
  ];

  let sketchfabAPI = null;

  function loadQuestion(index) {
    const container = document.getElementById('question-container');
    container.innerHTML = `<p><strong>${questions[index].question}</strong></p>`;
    questions[index].options.forEach(opt => {
      const btn = document.createElement('button');
      btn.innerText = opt;
      btn.onclick = () => checkAnswer(opt, questions[index].correct, questions[index].annotationIndex);
      container.appendChild(btn);
    });
  }

  function checkAnswer(selected, correct, annotationIndex) {
    if (selected === correct) {
      alert("✅ Correct!");
      score++;
      if (sketchfabAPI) sketchfabAPI.showAnnotation(annotationIndex);
    } else {
      alert("❌ Incorrect. Review the labeled model carefully.");
    }
  }

  function nextQuestion() {
    currentQuestionIndex++;
    if (currentQuestionIndex < questions.length) {
      loadQuestion(currentQuestionIndex);
    } else {
      document.getElementById('quiz-overlay').innerHTML = 
        `<p><strong>Quiz Complete!</strong><br>Your score: ${score} / ${questions.length}</p>`;
    }
  }

  // Initialize Sketchfab viewer and load first question
  client.init(uid, {
    success: function(api) {
      sketchfabAPI = api;
      api.start();
      api.addEventListener('viewerready', function() {
        console.log('Viewer is ready');
        loadQuestion(currentQuestionIndex);
      });
    },
    error: function() {
      console.error('Viewer load failed.');
    }
  });
</script>

</body>
</html>
